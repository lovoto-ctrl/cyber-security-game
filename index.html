<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Defense: Operation Security</title>
    <style>
        :root {
            --neon-green: #00ff41;
            --dark-bg: #0d0d0d;
            --hacker-red: #ff3e3e;
            --terminal-gray: #1a1a1a;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--neon-green);
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-container {
            width: 800px;
            height: 550px;
            background: var(--terminal-gray);
            border: 2px solid var(--neon-green);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.2);
            padding: 20px;
            position: relative;
            display: flex;
            flex-direction: column;
            z-index: 2;
        }

        #terminal-header {
            border-bottom: 1px solid var(--neon-green);
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }

        .status-bar { font-size: 0.9em; font-weight: bold; }

        #alert-system {
            color: var(--hacker-red);
            font-weight: bold;
            animation: blink 1s infinite;
        }

        @keyframes blink { 50% { opacity: 0; } }

        #content-area { flex-grow: 1; }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.4;
            min-height: 60px;
            color: #fff;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        button {
            background: transparent;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            font-family: inherit;
        }

        button:hover {
            background: var(--neon-green);
            color: black;
        }

        #progress-bar-container {
            width: 100%;
            height: 10px;
            background: #333;
            margin-top: 20px;
        }

        #progress-fill {
            height: 100%;
            background: var(--neon-green);
            width: 0%;
            transition: width 0.5s;
        }

        #matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0.15;
        }
        
        .screen-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 0, 0.3);
            pointer-events: none;
            display: none;
            z-index: 3;
        }
    </style>
</head>
<body>

<canvas id="matrix-bg"></canvas>
<div class="screen-overlay" id="danger-overlay"></div>

<div id="game-container">
    <div id="terminal-header">
        <div class="status-bar">STATUS: <span id="defense-status">SẴN SÀNG</span></div>
        <div id="alert-system">SECURITY: ACTIVE</div>
        <div class="status-bar">SHIELD: <span id="shield-percent">100%</span></div>
    </div>

    <div id="content-area">
        <div id="intro">
            <h2 style="color: var(--hacker-red)">CẢNH BÁO: PHÁT HIỆN RANSOMWARE!</h2>
            <p>Hệ thống đang bị tấn công. Các đáp án đã được xáo trộn để gây nhiễu.</p>
            <p>Hãy trả lời đúng 20 câu hỏi để đẩy lùi mã độc khỏi máy tính.</p>
            <button onclick="startGame()" style="text-align:center; display:block; margin: 20px auto; width: 250px;">BẮT ĐẦU PHÒNG THỦ</button>
        </div>
        <div id="quiz" style="display:none;">
            <div class="question-text" id="q-text">Đang kết nối...</div>
            <div class="options-grid" id="q-options"></div>
        </div>
        <div id="result" style="display:none; text-align: center;">
            <h2 id="result-title"></h2>
            <p id="result-desc"></p>
            <button onclick="location.reload()" style="text-align:center; display:block; margin: 20px auto; width: 200px;">KHỞI ĐỘNG LẠI</button>
        </div>
    </div>

    <div id="progress-bar-container">
        <div id="progress-fill"></div>
    </div>
</div>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        switch(type) {
            case 'correct':
                osc.type = 'sine';
                osc.frequency.setValueAtTime(880, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(440, audioCtx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
                break;
            case 'wrong':
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(110, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
                break;
            case 'win':
                [440, 554, 659, 880].forEach((f, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.connect(g); g.connect(audioCtx.destination);
                    o.frequency.value = f;
                    g.gain.setValueAtTime(0.1, audioCtx.currentTime + i*0.15);
                    g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + i*0.15 + 0.4);
                    o.start(audioCtx.currentTime + i*0.15); o.stop(audioCtx.currentTime + i*0.15 + 0.4);
                });
                break;
            case 'lose':
                osc.type = 'square';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(40, audioCtx.currentTime + 1);
                gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 1);
                osc.start(); osc.stop(audioCtx.currentTime + 1);
                break;
        }
    }

    const questions = [
        { q: "Thông tin cá nhân được hiểu là gì?", a: ["Thông tin dùng để xác định danh tính của một cá nhân.", "Lịch sử tìm kiếm trên web.", "Danh sách các ứng dụng đã tải.", "Cấu hình phần cứng máy tính."], correct: 0 },
        { q: "Ví dụ nào sau đây là thông tin cá nhân tiêu biểu?", a: ["Thời tiết, địa điểm du lịch.", "Họ tên, ngày sinh, số điện thoại.", "Tên các loại virus mạng.", "Hãng sản xuất linh kiện máy tính."], correct: 1 },
        { q: "Ransomware là loại phần mềm gì?", a: ["Phần mềm giúp tăng tốc máy tính.", "Phần mềm dọn dẹp hệ thống.", "Mã độc mã hóa dữ liệu để tống tiền.", "Ứng dụng nhắn tin bảo mật."], correct: 2 },
        { q: "Khi bị ransomware, tin tặc thường ép người dùng phải làm gì?", a: ["Cài đặt lại hệ điều hành.", "Tắt nguồn máy tính.", "Mua thêm ổ cứng mới.", "Trả tiền chuộc để lấy lại dữ liệu."], correct: 3 },
        { q: "Nguyên nhân nào sau đây khiến máy tính dễ nhiễm mã độc?", a: ["Vệ sinh máy tính không sạch.", "Sử dụng máy tính quá nhiều giờ.", "Tải phần mềm không rõ nguồn gốc.", "Để màn hình quá sáng."], correct: 2 },
        { q: "Vì sao không nên mở các tệp đính kèm từ email lạ?", a: ["Vì có thể chứa mã độc gây hại.", "Vì tốn dung lượng ổ cứng.", "Vì email sẽ tự biến mất.", "Vì làm hỏng bàn phím."], correct: 0 },
        { q: "Giao thức web an toàn thường bắt đầu bằng cụm từ nào?", a: ["http://", "www.", "https://", "ftp://"], correct: 2 },
        { q: "Mục đích của việc kiểm tra kỹ địa chỉ web (URL) là gì?", a: ["Để trang web tải nhanh hơn.", "Để biết người lập trình web.", "Để lưu trang web dễ dàng hơn.", "Để tránh truy cập website giả mạo."], correct: 3 },
        { q: "Mật khẩu mạnh cần hội tụ đặc điểm nào?", a: ["Chỉ gồm các chữ cái viết hoa.", "Kết hợp chữ, số và ký tự đặc biệt.", "Chỉ dùng số điện thoại cá nhân.", "Sử dụng tên thú cưng."], correct: 1 },
        { q: "Xác thực hai yếu tố (2FA) là phương thức như thế nào?", a: ["Dùng mật khẩu kết hợp thêm một yếu tố khác (OTP, vân tay).", "Dùng 2 mật khẩu khác nhau.", "Đăng nhập trên 2 máy cùng lúc.", "Yêu cầu 2 người cùng đăng nhập."], correct: 0 },
        { q: "Tại sao không nên dùng ngày sinh làm mật khẩu?", a: ["Vì nó quá dài.", "Vì nó mang lại xui xẻo.", "Vì hệ thống không cho phép.", "Vì dễ đoán và dễ bị thu thập."], correct: 3 },
        { q: "Tại sao không nên dùng wifi công cộng để giao dịch tài chính?", a: ["Vì dễ bị kẻ xấu đánh cắp thông tin giao dịch.", "Vì tốc độ mạng chậm.", "Vì làm tốn pin điện thoại.", "Vì ngân hàng sẽ khóa tài khoản."], correct: 0 },
        { q: "Sau khi dùng máy tính lạ, thao tác nào quan trọng nhất?", a: ["Xóa lịch sử tìm kiếm.", "Tắt màn hình máy tính.", "Đăng xuất (Log out) tài khoản.", "Xóa ứng dụng vừa dùng."], correct: 2 },
        { q: "Một trong những trách nhiệm cá nhân trên không gian mạng?", a: ["Tuân thủ pháp luật về an ninh mạng.", "Phá khóa phần mềm lậu.", "Chia sẻ tin đồn giật gân.", "Sử dụng biệt danh để công kích."], correct: 0 },
        { q: "Khi phát hiện hành vi xâm phạm an ninh mạng, bạn nên làm gì?", a: ["Im lặng bỏ qua.", "Tự mình tấn công trả đũa.", "Báo cho cơ quan chức năng có thẩm quyền.", "Chia sẻ lên hội nhóm kín."], correct: 2 },
        { q: "Quy tắc ứng xử trên mạng xã hội nhằm mục đích gì?", a: ["Đảm bảo môi trường văn minh, an toàn.", "Tăng số lượt người theo dõi.", "Kiểm soát lợi nhuận công ty mạng.", "Hạn chế người dùng truy cập."], correct: 0 },
        { q: "Hành vi ứng xử trên mạng xã hội cần phù hợp với điều gì?", a: ["Số lượng lượt Like nhận được.", "Sở thích cá nhân tại thời điểm đó.", "Các trào lưu đang nổi tiếng.", "Giá trị đạo đức và văn hóa truyền thống."], correct: 3 },
        { q: "Học sinh đóng góp bảo vệ an ninh mạng bằng cách nào?", a: ["Học cách bẻ khóa tài khoản.", "Sử dụng mạng an toàn, đúng quy định.", "Không dùng Internet nữa.", "Chia sẻ mật khẩu cho bạn bè."], correct: 1 },
        { q: "Thông tin nào được coi là bí mật cá nhân cần bảo vệ?", a: ["Hồ sơ y tế, tình trạng sức khỏe.", "Tên các trò chơi đã tải.", "Thời khóa biểu của lớp.", "Địa chỉ quán ăn yêu thích."], correct: 0 },
        { q: "Việc chia sẻ thông tin cá nhân lên mạng có an toàn không?", a: ["Rất an toàn vì có bảo mật.", "An toàn nếu chỉ gửi cho bạn bè.", "Không, vì có nguy cơ bị lạm dụng.", "Chỉ an toàn nếu dùng điện thoại xịn."], correct: 2 }
    ];

    let currentQuestion = 0;
    let shield = 100;

    function startGame() {
        audioCtx.resume();
        document.getElementById('intro').style.display = 'none';
        document.getElementById('quiz').style.display = 'block';
        showQuestion();
    }

    function showQuestion() {
        const q = questions[currentQuestion];
        document.getElementById('q-text').innerText = `[LOG #${currentQuestion + 1}]: ${q.q}`;
        const optionsDiv = document.getElementById('q-options');
        optionsDiv.innerHTML = '';
        
        q.a.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(index);
            optionsDiv.appendChild(btn);
        });

        document.getElementById('progress-fill').style.width = `${(currentQuestion / questions.length) * 100}%`;
    }

    function checkAnswer(choice) {
        if (choice === questions[currentQuestion].correct) {
            playSound('correct');
            currentQuestion++;
            updateStatus("PHÒNG THỦ THÀNH CÔNG", "THẤP", false);
        } else {
            playSound('wrong');
            shield -= 20;
            updateStatus("CẢNH BÁO: HỆ THỐNG BỊ XÂM NHẬP", "NGUY HIỂM", true);
        }

        if (shield <= 0) {
            playSound('lose');
            endGame(false);
        } else if (currentQuestion >= questions.length) {
            playSound('win');
            endGame(true);
        } else {
            showQuestion();
        }
    }

    function updateStatus(msg, level, danger) {
        document.getElementById('defense-status').innerText = msg;
        document.getElementById('alert-system').innerText = `THREAT: ${level}`;
        document.getElementById('shield-percent').innerText = `${shield}%`;
        document.getElementById('danger-overlay').style.display = danger ? 'block' : 'none';
        if(danger) {
            document.getElementById('defense-status').style.color = 'var(--hacker-red)';
            setTimeout(() => { document.getElementById('danger-overlay').style.display = 'none'; }, 200);
        } else {
            document.getElementById('defense-status').style.color = 'var(--neon-green)';
        }
    }

    function endGame(win) {
        document.getElementById('quiz').style.display = 'none';
        document.getElementById('result').style.display = 'block';
        document.getElementById('progress-fill').style.width = `100%`;
        
        if (win) {
            document.getElementById('result-title').innerText = "HỆ THỐNG AN TOÀN!";
            document.getElementById('result-desc').innerText = "Tin tặc đã bị đẩy lùi. Bạn đã hoàn thành xuất sắc nhiệm vụ phòng thủ.";
            document.getElementById('result-title').style.color = "var(--neon-green)";
        } else {
            document.getElementById('result-title').innerText = "HỆ THỐNG THẤT THỦ!";
            document.getElementById('result-desc').innerText = "Dữ liệu đã bị mã hóa hoàn toàn. Hãy nâng cao kiến thức và thử lại sau.";
            document.getElementById('result-title').style.color = "var(--hacker-red)";
        }
    }

    const canvas = document.getElementById('matrix-bg');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const chars = "01";
    const fontSize = 15;
    const columns = canvas.width / fontSize;
    const drops = Array(Math.floor(columns)).fill(1);

    function drawMatrix() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#0F0";
        ctx.font = fontSize + "px arial";
        for (let i = 0; i < drops.length; i++) {
            const text = chars[Math.floor(Math.random() * chars.length)];
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);
            if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        }
    }
    setInterval(drawMatrix, 50);
</script>

</body>
</html>
